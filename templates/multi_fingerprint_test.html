<!DOCTYPE html>
<html lang="en" class="multi-fingerprint-page">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.5, maximum-scale=3.0">
    <title>Multi-Finger Scanner - Biometric Crime Detection</title>
    <link rel="stylesheet" href="/css/style.css">
    <style>
        * {
            box-sizing: border-box;
        }
        
        html {
            width: 100% !important;
            height: auto !important;
            min-height: 100% !important;
            max-height: none !important;
            overflow: auto !important;
            overflow-x: auto !important;
            overflow-y: auto !important;
            scroll-behavior: smooth !important;
            position: static !important;
        }
        
        /* Force scrolling with highest specificity */
        html.multi-fingerprint-page {
            overflow: auto !important;
            overflow-x: auto !important;
            overflow-y: auto !important;
            height: auto !important;
            max-height: none !important;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif !important;
            background: linear-gradient(135deg, #0f1419 0%, #1a2332 100%) !important;
            background-attachment: fixed !important;
            color: #e0e0e0 !important;
            margin: 0 !important;
            padding: 20px !important;
            width: 100% !important;
            height: auto !important;
            min-height: 100vh !important;
            max-height: none !important;
            overflow: visible !important;
            overflow-x: auto !important;
            overflow-y: auto !important;
            position: static !important;
        }
        
        /* Force override any conflicting styles */
        body.multi-fingerprint-page {
            height: auto !important;
            overflow: auto !important;
            overflow-x: auto !important;
            overflow-y: auto !important;
            position: static !important;
        }
        
        /* Custom scrollbar styling */
        body::-webkit-scrollbar {
            width: 12px;
        }
        
        body::-webkit-scrollbar-track {
            background: rgba(16, 24, 38, 0.5);
            border-radius: 6px;
        }
        
        body::-webkit-scrollbar-thumb {
            background: linear-gradient(45deg, #4cc9f0, #7209b7);
            border-radius: 6px;
        }
        
        body::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(45deg, #00ff88, #4cc9f0);
        }
        
        .scanner-container {
            max-width: 1200px;
            width: 100%;
            margin: 0 auto 40px auto;
            background: rgba(16, 24, 38, 0.85);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
            min-height: auto;
            height: auto;
            position: relative;
            overflow: visible;
        }
        
        /* Ensure all containers allow scrolling */
        .scanner-container, .scanning-area, .status-panel, .controls {
            overflow: visible !important;
            height: auto !important;
            max-height: none !important;
        }
        
        @media (max-width: 768px) {
            .scanner-container {
                margin: 0 10px 40px 10px;
                padding: 20px;
            }
            
            body {
                padding: 10px;
            }
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid rgba(76, 201, 240, 0.3);
            padding-bottom: 20px;
        }
        
        .header h1 {
            color: #4cc9f0;
            margin: 0;
            font-size: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }
        
        .stage-indicator {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stage {
            background: rgba(76, 201, 240, 0.1);
            border: 2px solid rgba(76, 201, 240, 0.3);
            border-radius: 10px;
            padding: 15px 25px;
            text-align: center;
            min-width: 200px;
        }
        
        .stage.active {
            background: rgba(0, 255, 136, 0.2);
            border-color: #00ff88;
        }
        
        .stage.completed {
            background: rgba(0, 255, 136, 0.1);
            border-color: rgba(0, 255, 136, 0.5);
        }
        
        .stage-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .stage-desc {
            font-size: 14px;
            color: #a0a0a0;
        }
        
        .scanning-area {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .finger-grid {
            background: linear-gradient(145deg, #2a3441, #1e2832);
            border-radius: 15px;
            padding: 25px;
            border: 2px solid rgba(76, 201, 240, 0.3);
        }
        
        .grid-title {
            text-align: center;
            color: #4cc9f0;
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 20px;
        }
        
        .fingers-layout {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .thumbs-layout {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            justify-items: center;
        }
        
        .finger-slot {
            width: 80px;
            height: 100px;
            background: linear-gradient(45deg, #1a4d3a, #0d2818);
            border: 2px solid #333;
            border-radius: 40px 40px 20px 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            text-align: center;
            color: #666;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .thumb-slot {
            width: 90px;
            height: 110px;
            background: linear-gradient(45deg, #1a4d3a, #0d2818);
            border: 2px solid #333;
            border-radius: 45px 45px 25px 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            text-align: center;
            color: #666;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .finger-slot.scanning, .thumb-slot.scanning {
            border-color: #ffc107;
            background: linear-gradient(45deg, #4d3a1a, #2d1f0a);
            animation: scanPulse 2s infinite;
        }
        
        .finger-slot.scanned, .thumb-slot.scanned {
            border-color: #00ff88;
            background: linear-gradient(45deg, #1a4d3a, #0f3d2a);
            color: #00ff88;
        }
        
        @keyframes scanPulse {
            0%, 100% { box-shadow: 0 0 10px rgba(255, 193, 7, 0.5); }
            50% { box-shadow: 0 0 25px rgba(255, 193, 7, 0.8), inset 0 0 20px rgba(255, 193, 7, 0.2); }
        }
        
        .scan-line {
            position: absolute;
            width: 100%;
            height: 2px;
            background: linear-gradient(90deg, transparent, #ffc107, transparent);
            top: 0;
            animation: scanLine 2s infinite;
            opacity: 0;
        }
        
        .finger-slot.scanning .scan-line, .thumb-slot.scanning .scan-line {
            opacity: 1;
        }
        
        @keyframes scanLine {
            0% { top: 0; }
            100% { top: calc(100% - 2px); }
        }
        
        .status-panel {
            background: rgba(76, 201, 240, 0.1);
            border: 1px solid rgba(76, 201, 240, 0.3);
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 20px;
        }
        
        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .status-item {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #4cc9f0;
        }
        
        .status-label {
            font-size: 12px;
            color: #4cc9f0;
            margin-bottom: 5px;
        }
        
        .status-value {
            font-size: 18px;
            font-weight: bold;
            color: #e0e0e0;
        }
        
        .controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 20px;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
            min-width: 150px;
            justify-content: center;
        }
        
        .btn-primary {
            background: linear-gradient(45deg, #4cc9f0, #7209b7);
            color: white;
        }
        
        .btn-success {
            background: linear-gradient(45deg, #00ff88, #00cc6a);
            color: white;
        }
        
        .btn-warning {
            background: linear-gradient(45deg, #ffc107, #e0a800);
            color: #000;
        }
        
        .btn-danger {
            background: linear-gradient(45deg, #ff453a, #cc3629);
            color: white;
        }
        
        .btn-secondary {
            background: rgba(76, 201, 240, 0.1);
            color: #4cc9f0;
            border: 1px solid rgba(76, 201, 240, 0.3);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(76, 201, 240, 0.4);
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .progress-bar {
            width: 100%;
            height: 25px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            overflow: hidden;
            margin: 15px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4cc9f0, #00ff88);
            width: 0%;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 12px;
        }
        
        .scan-results {
            background: rgba(255, 193, 7, 0.1);
            border: 1px solid rgba(255, 193, 7, 0.3);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            display: none;
        }
        
        .scan-results.show {
            display: block;
        }
        
        .finger-labels {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-top: 10px;
        }
        
        .thumb-labels {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 10px;
            text-align: center;
        }
        
        .finger-label {
            font-size: 10px;
            color: #a0a0a0;
            text-align: center;
        }
        
        /* Floating scroll buttons */
        .scroll-buttons {
            position: fixed;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 1000;
        }
        
        /* Directional navigation controls */
        .direction-controls {
            position: fixed;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            display: grid;
            grid-template-columns: repeat(3, 50px);
            grid-template-rows: repeat(3, 50px);
            gap: 5px;
            z-index: 1000;
        }
        
        .direction-btn {
            width: 50px;
            height: 50px;
            border-radius: 8px;
            background: linear-gradient(45deg, #4cc9f0, #7209b7);
            border: none;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(76, 201, 240, 0.3);
        }
        
        .direction-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(76, 201, 240, 0.5);
            background: linear-gradient(45deg, #00ff88, #4cc9f0);
        }
        
        .direction-btn:active {
            transform: scale(0.95);
        }
        
        .direction-btn.up {
            grid-column: 2;
            grid-row: 1;
        }
        
        .direction-btn.left {
            grid-column: 1;
            grid-row: 2;
        }
        
        .direction-btn.center {
            grid-column: 2;
            grid-row: 2;
            background: linear-gradient(45deg, #ff6b35, #f7931e);
            font-size: 14px;
        }
        
        .direction-btn.right {
            grid-column: 3;
            grid-row: 2;
        }
        
        .direction-btn.down {
            grid-column: 2;
            grid-row: 3;
        }
        
        .scroll-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(45deg, #4cc9f0, #7209b7);
            border: none;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(76, 201, 240, 0.3);
        }
        
        .scroll-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(76, 201, 240, 0.5);
            background: linear-gradient(45deg, #00ff88, #4cc9f0);
        }
        
        .scroll-btn:active {
            transform: scale(0.95);
        }
        
        /* Scroll indicator */
        .scroll-indicator {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: rgba(76, 201, 240, 0.2);
            z-index: 1001;
        }
        
        .scroll-progress {
            height: 100%;
            background: linear-gradient(90deg, #4cc9f0, #00ff88);
            width: 0%;
            transition: width 0.1s ease;
        }
    </style>
</head>
<body class="multi-fingerprint-page">
    <!-- Scroll Progress Indicator -->
    <div class="scroll-indicator">
        <div class="scroll-progress" id="scrollProgress"></div>
    </div>
    
    <!-- Directional Navigation Controls -->
    <div class="direction-controls">
        <button class="direction-btn up" onclick="moveUp()" title="Move Up">
            <i class="fas fa-chevron-up"></i>
        </button>
        <button class="direction-btn left" onclick="moveLeft()" title="Move Left">
            <i class="fas fa-chevron-left"></i>
        </button>
        <button class="direction-btn center" onclick="centerView()" title="Center View">
            <i class="fas fa-crosshairs"></i>
        </button>
        <button class="direction-btn right" onclick="moveRight()" title="Move Right">
            <i class="fas fa-chevron-right"></i>
        </button>
        <button class="direction-btn down" onclick="moveDown()" title="Move Down">
            <i class="fas fa-chevron-down"></i>
        </button>
    </div>
    
    <!-- Floating Scroll Buttons -->
    <div class="scroll-buttons">
        <button class="scroll-btn" onclick="scrollToTop()" title="Scroll to Top">
            <i class="fas fa-chevron-up"></i>
        </button>
        <button class="scroll-btn" onclick="scrollToSection('stage-indicator')" title="Go to Stages">
            <i class="fas fa-list"></i>
        </button>
        <button class="scroll-btn" onclick="scrollToSection('scanning-area')" title="Go to Scanner">
            <i class="fas fa-hand-paper"></i>
        </button>
        <button class="scroll-btn" onclick="scrollToSection('controls')" title="Go to Controls">
            <i class="fas fa-cog"></i>
        </button>
        <button class="scroll-btn" onclick="scrollToBottom()" title="Scroll to Bottom">
            <i class="fas fa-chevron-down"></i>
        </button>
    </div>
    
    <div class="scanner-container">
        <div class="header">
            <h1><i class="fas fa-hand-paper"></i> Multi-Finger Scanner (8+2)</h1>
            <p>Professional 10-finger biometric identification system</p>
        </div>
        
        <!-- Stage Indicator -->
        <div class="stage-indicator" id="stage-indicator">
            <div class="stage active" id="stage1">
                <div class="stage-title">Stage 1</div>
                <div class="stage-desc">8 Fingers (No Thumbs)</div>
            </div>
            <div class="stage" id="stage2">
                <div class="stage-title">Stage 2</div>
                <div class="stage-desc">2 Thumbs</div>
            </div>
        </div>
        
        <!-- Progress Bar -->
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill">0/10 Fingers</div>
        </div>
        
        <!-- Scanning Area -->
        <div class="scanning-area" id="scanning-area">
            <!-- 8 Fingers Grid -->
            <div class="finger-grid" id="fingersGrid">
                <div class="grid-title">8 Fingers (Exclude Thumbs)</div>
                <div class="fingers-layout">
                    <div class="finger-slot" id="finger0"><div class="scan-line"></div>R.Index</div>
                    <div class="finger-slot" id="finger1"><div class="scan-line"></div>R.Middle</div>
                    <div class="finger-slot" id="finger2"><div class="scan-line"></div>R.Ring</div>
                    <div class="finger-slot" id="finger3"><div class="scan-line"></div>R.Pinky</div>
                    <div class="finger-slot" id="finger4"><div class="scan-line"></div>L.Index</div>
                    <div class="finger-slot" id="finger5"><div class="scan-line"></div>L.Middle</div>
                    <div class="finger-slot" id="finger6"><div class="scan-line"></div>L.Ring</div>
                    <div class="finger-slot" id="finger7"><div class="scan-line"></div>L.Pinky</div>
                </div>
                <div class="finger-labels">
                    <div class="finger-label">Right Index</div>
                    <div class="finger-label">Right Middle</div>
                    <div class="finger-label">Right Ring</div>
                    <div class="finger-label">Right Pinky</div>
                    <div class="finger-label">Left Index</div>
                    <div class="finger-label">Left Middle</div>
                    <div class="finger-label">Left Ring</div>
                    <div class="finger-label">Left Pinky</div>
                </div>
            </div>
            
            <!-- 2 Thumbs Grid -->
            <div class="finger-grid" id="thumbsGrid" style="opacity: 0.5;">
                <div class="grid-title">2 Thumbs</div>
                <div class="thumbs-layout">
                    <div class="thumb-slot" id="thumb0"><div class="scan-line"></div>R.Thumb</div>
                    <div class="thumb-slot" id="thumb1"><div class="scan-line"></div>L.Thumb</div>
                </div>
                <div class="thumb-labels">
                    <div class="finger-label">Right Thumb</div>
                    <div class="finger-label">Left Thumb</div>
                </div>
            </div>
        </div>
        
        <!-- Status Panel -->
        <div class="status-panel">
            <h3><i class="fas fa-chart-line"></i> Scanner Status</h3>
            <div class="status-grid">
                <div class="status-item">
                    <div class="status-label">Current Stage</div>
                    <div class="status-value" id="currentStage">Stage 1</div>
                </div>
                <div class="status-item">
                    <div class="status-label">Scanner Status</div>
                    <div class="status-value" id="scannerStatus">Ready</div>
                </div>
                <div class="status-item">
                    <div class="status-label">Fingers Scanned</div>
                    <div class="status-value" id="fingersScanned">0/10</div>
                </div>
                <div class="status-item">
                    <div class="status-label">Scan Quality</div>
                    <div class="status-value" id="scanQuality">0%</div>
                </div>
            </div>
        </div>
        
        <!-- Controls -->
        <div class="controls" id="controls">
            <button id="startMultiScanBtn" class="btn btn-success" onclick="startMultiScan()">
                <i class="fas fa-play"></i> Start 8-Finger Scan
            </button>
            <button id="nextStageBtn" class="btn btn-warning" onclick="proceedToNextStage()" disabled>
                <i class="fas fa-arrow-right"></i> Scan Thumbs
            </button>
            <button id="startFullScanBtn" class="btn btn-primary" onclick="startFullScan()" style="background: linear-gradient(45deg, #ff6b35, #f7931e); font-weight: bold;">
                <i class="fas fa-database"></i> Start Full Scan
            </button>
            <button id="matchBtn" class="btn btn-primary" onclick="matchFingerprints()" disabled>
                <i class="fas fa-search"></i> Match Database
            </button>
            <button id="clearBtn" class="btn btn-danger" onclick="clearScan()">
                <i class="fas fa-eraser"></i> Clear All
            </button>
            <a href="/home" class="btn btn-secondary">
                <i class="fas fa-home"></i> Dashboard
            </a>
        </div>
        
        <!-- Scan Results -->
        <div class="scan-results" id="scanResults">
            <div class="result-header" id="resultHeader">
                <i class="fas fa-info-circle"></i> Scan Results
            </div>
            <div class="result-details" id="resultDetails">
                Scan results will appear here...
            </div>
        </div>
        
        <!-- Additional Information Section for Testing Scroll -->
        <div style="margin-top: 40px; padding: 30px; background: rgba(76, 201, 240, 0.1); border-radius: 10px; border: 1px solid rgba(76, 201, 240, 0.3);">
            <h3><i class="fas fa-info-circle"></i> Multi-Finger Scanner Information</h3>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 20px;">
                <div>
                    <h4>Stage 1: 8-Finger Scanning</h4>
                    <ul>
                        <li>Right Hand: Index, Middle, Ring, Pinky</li>
                        <li>Left Hand: Index, Middle, Ring, Pinky</li>
                        <li>Simultaneous capture and quality assessment</li>
                        <li>Individual finger quality scoring (85-98%)</li>
                        <li>Automatic progression to Stage 2</li>
                    </ul>
                </div>
                <div>
                    <h4>Stage 2: 2-Thumb Scanning</h4>
                    <ul>
                        <li>Right Thumb and Left Thumb</li>
                        <li>Separate scanning session</li>
                        <li>Combined with Stage 1 data</li>
                        <li>Complete 10-finger profile</li>
                        <li>Ready for database matching</li>
                    </ul>
                </div>
                <div>
                    <h4>Criminal Database Matching</h4>
                    <ul>
                        <li>Searches against active criminal records</li>
                        <li>20% realistic detection probability</li>
                        <li>85-97% confidence for positive matches</li>
                        <li>Complete criminal profile display</li>
                        <li>Authority alert notifications</li>
                    </ul>
                </div>
                <div>
                    <h4>Technical Specifications</h4>
                    <ul>
                        <li>Resolution: 500 DPI</li>
                        <li>Scan Area: 20mm x 25mm per finger</li>
                        <li>Quality Threshold: 70% minimum</li>
                        <li>Processing Time: 2-3 seconds per stage</li>
                        <li>Data Format: Base64 encoded images</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- Usage Instructions -->
        <div style="margin-top: 30px; padding: 25px; background: rgba(0, 255, 136, 0.1); border-radius: 10px; border: 1px solid rgba(0, 255, 136, 0.3);">
            <h3><i class="fas fa-hand-paper"></i> How to Use the Multi-Finger Scanner</h3>
            <div style="margin-top: 20px;">
                <h4>Step-by-Step Instructions:</h4>
                <ol style="line-height: 1.8;">
                    <li><strong>Start 8-Finger Scan:</strong> Click the "Start 8-Finger Scan" button to begin Stage 1</li>
                    <li><strong>Place 8 Fingers:</strong> Position all fingers except thumbs on the scanner surface</li>
                    <li><strong>Wait for Capture:</strong> Watch as each finger slot lights up and scans individually</li>
                    <li><strong>Stage 1 Complete:</strong> All 8 fingers will show green checkmarks when successfully scanned</li>
                    <li><strong>Proceed to Thumbs:</strong> Click "Scan Thumbs" button to start Stage 2</li>
                    <li><strong>Place Thumbs:</strong> Position both thumbs on the designated thumb scanning areas</li>
                    <li><strong>Complete Scan:</strong> Wait for both thumbs to be captured and processed</li>
                    <li><strong>Database Match:</strong> Click "Match Database" to search for criminal records</li>
                    <li><strong>View Results:</strong> Review the matching results and take appropriate action</li>
                </ol>
            </div>
        </div>
        
        <!-- Keyboard Shortcuts Guide -->
        <div style="margin-top: 30px; padding: 25px; background: rgba(255, 193, 7, 0.1); border-radius: 10px; border: 1px solid rgba(255, 193, 7, 0.3); margin-bottom: 50px;">
            <h3><i class="fas fa-keyboard"></i> Navigation & Keyboard Shortcuts</h3>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-top: 20px;">
                <div>
                    <h4>Scrolling Controls:</h4>
                    <ul>
                        <li><kbd>Home</kbd> - Scroll to top of page</li>
                        <li><kbd>End</kbd> - Scroll to bottom of page</li>
                        <li><kbd>Page Up</kbd> - Scroll up by screen height</li>
                        <li><kbd>Page Down</kbd> - Scroll down by screen height</li>
                        <li><kbd>Mouse Wheel</kbd> - Smooth scrolling</li>
                    </ul>
                </div>
                <div>
                    <h4>Floating Navigation Buttons:</h4>
                    <ul>
                        <li><i class="fas fa-chevron-up"></i> - Scroll to top</li>
                        <li><i class="fas fa-list"></i> - Go to stage indicators</li>
                        <li><i class="fas fa-hand-paper"></i> - Go to scanner area</li>
                        <li><i class="fas fa-cog"></i> - Go to controls</li>
                        <li><i class="fas fa-chevron-down"></i> - Scroll to bottom</li>
                    </ul>
                </div>
                <div>
                    <h4>Scanner Controls:</h4>
                    <ul>
                        <li>Start 8-Finger Scan - Begin Stage 1</li>
                        <li>Scan Thumbs - Proceed to Stage 2</li>
                        <li>Match Database - Search criminals</li>
                        <li>Clear All - Reset scanner</li>
                        <li>Dashboard - Return to main menu</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        let isScanning = false;
        let currentStage = 1;
        let scannedFingers = 0;
        let statusInterval = null;
        
        // Force enable scrolling with aggressive overrides
        function forceEnableScrolling() {
            // Force styles on HTML element
            document.documentElement.style.setProperty('overflow', 'auto', 'important');
            document.documentElement.style.setProperty('overflow-x', 'auto', 'important');
            document.documentElement.style.setProperty('overflow-y', 'auto', 'important');
            document.documentElement.style.setProperty('height', 'auto', 'important');
            document.documentElement.style.setProperty('max-height', 'none', 'important');
            document.documentElement.style.setProperty('position', 'static', 'important');
            
            // Force styles on Body element
            document.body.style.setProperty('overflow', 'auto', 'important');
            document.body.style.setProperty('overflow-x', 'auto', 'important');
            document.body.style.setProperty('overflow-y', 'auto', 'important');
            document.body.style.setProperty('height', 'auto', 'important');
            document.body.style.setProperty('max-height', 'none', 'important');
            document.body.style.setProperty('position', 'static', 'important');
            
            // Remove any conflicting CSS classes
            document.body.classList.remove('no-scroll', 'overflow-hidden');
            document.documentElement.classList.remove('no-scroll', 'overflow-hidden');
            
            // Force container styles
            const containers = document.querySelectorAll('.scanner-container, .scanning-area, .status-panel, .controls');
            containers.forEach(container => {
                container.style.setProperty('overflow', 'visible', 'important');
                container.style.setProperty('height', 'auto', 'important');
                container.style.setProperty('max-height', 'none', 'important');
            });
            
            // Remove any event listeners that might prevent scrolling
            document.removeEventListener('wheel', function() {});
            document.removeEventListener('touchmove', function() {});
            
            console.log('Aggressive scrolling force enabled');
            
            // Add debug info
            console.log('Document height:', document.documentElement.scrollHeight);
            console.log('Window height:', window.innerHeight);
            console.log('Body overflow:', getComputedStyle(document.body).overflow);
            console.log('HTML overflow:', getComputedStyle(document.documentElement).overflow);
            console.log('Can scroll:', document.documentElement.scrollHeight > window.innerHeight);
        }
        
        // Debug scroll function
        function testScroll() {
            window.scrollTo(0, 100);
            console.log('Scroll test executed - current scroll position:', window.pageYOffset);
        }
        
        // Add scroll test button functionality
        window.testScrollFunction = testScroll;
        
        // Directional navigation functions
        function moveUp() {
            const currentY = window.pageYOffset;
            const moveAmount = window.innerHeight * 0.3; // Move 30% of viewport height
            window.scrollTo({
                top: Math.max(0, currentY - moveAmount),
                behavior: 'smooth'
            });
        }
        
        function moveDown() {
            const currentY = window.pageYOffset;
            const moveAmount = window.innerHeight * 0.3; // Move 30% of viewport height
            const maxScroll = document.documentElement.scrollHeight - window.innerHeight;
            window.scrollTo({
                top: Math.min(maxScroll, currentY + moveAmount),
                behavior: 'smooth'
            });
        }
        
        function moveLeft() {
            const currentX = window.pageXOffset;
            const moveAmount = window.innerWidth * 0.3; // Move 30% of viewport width
            window.scrollTo({
                left: Math.max(0, currentX - moveAmount),
                behavior: 'smooth'
            });
        }
        
        function moveRight() {
            const currentX = window.pageXOffset;
            const moveAmount = window.innerWidth * 0.3; // Move 30% of viewport width
            const maxScroll = document.documentElement.scrollWidth - window.innerWidth;
            window.scrollTo({
                left: Math.min(maxScroll, currentX + moveAmount),
                behavior: 'smooth'
            });
        }
        
        function centerView() {
            const centerX = (document.documentElement.scrollWidth - window.innerWidth) / 2;
            const centerY = (document.documentElement.scrollHeight - window.innerHeight) / 2;
            window.scrollTo({
                left: Math.max(0, centerX),
                top: Math.max(0, centerY),
                behavior: 'smooth'
            });
        }
        
        // Enhanced keyboard navigation
        document.addEventListener('keydown', function(e) {
            // Only handle arrow keys when not in input fields
            if (e.target.tagName !== 'INPUT' && e.target.tagName !== 'TEXTAREA') {
                switch(e.key) {
                    case 'ArrowUp':
                        e.preventDefault();
                        moveUp();
                        break;
                    case 'ArrowDown':
                        e.preventDefault();
                        moveDown();
                        break;
                    case 'ArrowLeft':
                        e.preventDefault();
                        moveLeft();
                        break;
                    case 'ArrowRight':
                        e.preventDefault();
                        moveRight();
                        break;
                    case ' ':
                        e.preventDefault();
                        centerView();
                        break;
                }
            }
        });
        
        // Show hardware error alert
        function showHardwareErrorAlert(errorData) {
            let message = `âš ï¸ FINGERPRINT SCANNER HARDWARE NOT FOUND\n\n`;
            message += `Error: ${errorData.message}\n\n`;
            message += `Supported Devices:\n`;
            if (errorData.supported_devices) {
                errorData.supported_devices.forEach(device => {
                    message += `â€¢ ${device}\n`;
                });
            }
            message += `\nSolutions:\n`;
            if (errorData.solutions) {
                errorData.solutions.forEach(solution => {
                    message += `â€¢ ${solution}\n`;
                });
            }
            message += `\nPlease connect a compatible fingerprint scanner and restart the application.`;
            
            alert(message);
        }
        
        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            forceEnableScrolling();
            startStatusMonitoring();
            updateScrollProgress();
        });
        
        // Update scroll progress indicator
        function updateScrollProgress() {
            const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
            const scrollHeight = document.documentElement.scrollHeight - document.documentElement.clientHeight;
            const scrollPercent = (scrollTop / scrollHeight) * 100;
            
            document.getElementById('scrollProgress').style.width = scrollPercent + '%';
        }
        
        // Listen for scroll events
         window.addEventListener('scroll', updateScrollProgress, { passive: true });
         window.addEventListener('resize', updateScrollProgress, { passive: true });
        
        function startMultiScan() {
            fetch('/api/fingerprint/start_multi_scan', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                }
            })
            .then(response => response.json())
            .then(data => {
                if (data.status === 'success') {
                    isScanning = true;
                    currentStage = 1;
                    updateUI();
                    startStage1Animation();
                } else {
                    // Check for hardware detection error
                    if (data.error_code === 'HARDWARE_NOT_FOUND') {
                        showHardwareErrorAlert(data);
                    } else {
                        alert('Failed to start scanner: ' + data.message);
                    }
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Error starting scanner');
            });
        }
        
        function startFullScan() {
            // Disable the button and show loading state
            const fullScanBtn = document.getElementById('startFullScanBtn');
            fullScanBtn.disabled = true;
            fullScanBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Scanning All Fingers...';
            
            // Start the complete scanning process
            fetch('/api/fingerprint/start_multi_scan', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                }
            })
            .then(response => response.json())
            .then(data => {
                if (data.status === 'success') {
                    isScanning = true;
                    currentStage = 1;
                    updateUI();
                    
                    // Start Stage 1 animation
                    startStage1Animation();
                    
                    // Automatically proceed to Stage 2 after Stage 1 completes
                    setTimeout(() => {
                        proceedToNextStage();
                        
                        // Automatically match against database after Stage 2 completes
                        setTimeout(() => {
                            fullScanBtn.innerHTML = '<i class="fas fa-database"></i> Matching Database...';
                            matchFingerprints();
                            
                            // Reset button after matching
                            setTimeout(() => {
                                fullScanBtn.disabled = false;
                                fullScanBtn.innerHTML = '<i class="fas fa-database"></i> Start Full Scan';
                            }, 3000);
                        }, 6000); // Wait for Stage 2 to complete
                    }, 8500); // Wait for Stage 1 to complete
                } else {
                    // Check for hardware detection error
                    if (data.error_code === 'HARDWARE_NOT_FOUND') {
                        showHardwareErrorAlert(data);
                    } else {
                        alert('Failed to start full scan: ' + data.message);
                    }
                    fullScanBtn.disabled = false;
                    fullScanBtn.innerHTML = '<i class="fas fa-database"></i> Start Full Scan';
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Error starting full scan');
                fullScanBtn.disabled = false;
                fullScanBtn.innerHTML = '<i class="fas fa-database"></i> Start Full Scan';
            });
        }
        
        function proceedToNextStage() {
            fetch('/api/fingerprint/next_stage', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                }
            })
            .then(response => response.json())
            .then(data => {
                if (data.status === 'success') {
                    currentStage = 2;
                    updateUI();
                    startStage2Animation();
                } else {
                    alert('Failed to proceed: ' + data.message);
                }
            })
            .catch(error => {
                console.error('Error:', error);
            });
        }
        
        function matchFingerprints() {
            document.getElementById('matchBtn').disabled = true;
            document.getElementById('matchBtn').innerHTML = '<i class="fas fa-spinner fa-spin"></i> Matching...';
            
            fetch('/api/fingerprint/match', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                }
            })
            .then(response => response.json())
            .then(data => {
                displayResults(data);
                document.getElementById('matchBtn').disabled = false;
                document.getElementById('matchBtn').innerHTML = '<i class="fas fa-search"></i> Match Database';
            })
            .catch(error => {
                console.error('Error:', error);
                document.getElementById('matchBtn').disabled = false;
                document.getElementById('matchBtn').innerHTML = '<i class="fas fa-search"></i> Match Database';
            });
        }
        
        function clearScan() {
            fetch('/api/fingerprint/clear_scan', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                }
            })
            .then(response => response.json())
            .then(data => {
                resetUI();
            })
            .catch(error => {
                console.error('Error:', error);
            });
        }
        
        function startStage1Animation() {
            // Animate 8 fingers scanning
            for (let i = 0; i < 8; i++) {
                setTimeout(() => {
                    const finger = document.getElementById(`finger${i}`);
                    finger.classList.add('scanning');
                    
                    setTimeout(() => {
                        finger.classList.remove('scanning');
                        finger.classList.add('scanned');
                        finger.innerHTML = '<div class="scan-line"></div>âœ“';
                    }, 2000);
                }, i * 500);
            }
            
            // Enable next stage button after all fingers scanned
            setTimeout(() => {
                document.getElementById('nextStageBtn').disabled = false;
                document.getElementById('stage1').classList.add('completed');
                document.getElementById('stage1').classList.remove('active');
            }, 8 * 500 + 2000);
        }
        
        function startStage2Animation() {
            // Enable thumbs grid
            document.getElementById('thumbsGrid').style.opacity = '1';
            document.getElementById('stage2').classList.add('active');
            
            // Animate 2 thumbs scanning
            for (let i = 0; i < 2; i++) {
                setTimeout(() => {
                    const thumb = document.getElementById(`thumb${i}`);
                    thumb.classList.add('scanning');
                    
                    setTimeout(() => {
                        thumb.classList.remove('scanning');
                        thumb.classList.add('scanned');
                        thumb.innerHTML = '<div class="scan-line"></div>âœ“';
                    }, 2000);
                }, i * 1000);
            }
            
            // Enable match button after all thumbs scanned
            setTimeout(() => {
                document.getElementById('matchBtn').disabled = false;
                document.getElementById('stage2').classList.add('completed');
                document.getElementById('stage2').classList.remove('active');
                isScanning = false;
            }, 2 * 1000 + 2000);
        }
        
        function startStatusMonitoring() {
            statusInterval = setInterval(() => {
                fetch('/api/fingerprint/scan_status')
                .then(response => response.json())
                .then(data => {
                    updateStatus(data);
                })
                .catch(error => {
                    console.error('Status error:', error);
                });
            }, 1000);
        }
        
        function updateStatus(status) {
            document.getElementById('scannerStatus').textContent = status.status || 'Ready';
            document.getElementById('scanQuality').textContent = status.quality + '%';
            document.getElementById('fingersScanned').textContent = `${status.scanned_fingers_count || 0}/${status.total_fingers_needed || 10}`;
            document.getElementById('currentStage').textContent = `Stage ${status.scan_stage || 1}`;
            
            // Update progress bar
            const progress = ((status.scanned_fingers_count || 0) / (status.total_fingers_needed || 10)) * 100;
            const progressFill = document.getElementById('progressFill');
            progressFill.style.width = progress + '%';
            progressFill.textContent = `${status.scanned_fingers_count || 0}/${status.total_fingers_needed || 10} Fingers`;
        }
        
        function updateUI() {
            const startBtn = document.getElementById('startMultiScanBtn');
            const nextBtn = document.getElementById('nextStageBtn');
            
            if (isScanning) {
                startBtn.disabled = true;
            } else {
                startBtn.disabled = false;
            }
        }
        
        function resetUI() {
            // Reset all finger slots
            for (let i = 0; i < 8; i++) {
                const finger = document.getElementById(`finger${i}`);
                finger.classList.remove('scanning', 'scanned');
                finger.innerHTML = `<div class="scan-line"></div>${['R.Index', 'R.Middle', 'R.Ring', 'R.Pinky', 'L.Index', 'L.Middle', 'L.Ring', 'L.Pinky'][i]}`;
            }
            
            for (let i = 0; i < 2; i++) {
                const thumb = document.getElementById(`thumb${i}`);
                thumb.classList.remove('scanning', 'scanned');
                thumb.innerHTML = `<div class="scan-line"></div>${['R.Thumb', 'L.Thumb'][i]}`;
            }
            
            // Reset stages
            document.getElementById('stage1').classList.remove('completed', 'active');
            document.getElementById('stage1').classList.add('active');
            document.getElementById('stage2').classList.remove('completed', 'active');
            document.getElementById('thumbsGrid').style.opacity = '0.5';
            
            // Reset buttons
            document.getElementById('nextStageBtn').disabled = true;
            document.getElementById('matchBtn').disabled = true;
            
            // Reset progress
            document.getElementById('progressFill').style.width = '0%';
            document.getElementById('progressFill').textContent = '0/10 Fingers';
            
            // Hide results
            document.getElementById('scanResults').classList.remove('show');
            
            currentStage = 1;
            scannedFingers = 0;
            isScanning = false;
        }
        
        function displayResults(data) {
            const resultsDiv = document.getElementById('scanResults');
            const headerDiv = document.getElementById('resultHeader');
            const detailsDiv = document.getElementById('resultDetails');
            
            if (data.status === 'match_found') {
                resultsDiv.classList.add('show');
                headerDiv.innerHTML = '<i class="fas fa-exclamation-triangle"></i> CRIMINAL MATCH FOUND IN DATABASE!';
                
                const criminal = data.criminal_details;
                let detailsHtml = `<strong style="color: #ff453a; font-size: 18px;">ðŸš¨ WANTED CRIMINAL DETECTED</strong><br><br>`;
                detailsHtml += `<div style="background: rgba(255, 69, 58, 0.1); padding: 15px; border-radius: 8px; border-left: 4px solid #ff453a; margin: 10px 0;">`;
                detailsHtml += `<strong>Full Name:</strong> ${criminal.full_name}<br>`;
                detailsHtml += `<strong>Crime Type:</strong> ${criminal.crime}<br>`;
                detailsHtml += `<strong>Case ID:</strong> ${criminal.case_id}<br>`;
                detailsHtml += `<strong>Match Confidence:</strong> ${(data.confidence * 100).toFixed(1)}%<br>`;
                detailsHtml += `<strong>Scan Quality:</strong> ${data.scan_quality}%<br>`;
                detailsHtml += `<strong>Minutiae Matched:</strong> ${data.minutiae_matched || 'N/A'}<br>`;
                detailsHtml += `<strong>Database Search:</strong> Complete (All records checked)<br>`;
                detailsHtml += `<strong>Match Type:</strong> 10-Finger Full Scan<br>`;
                detailsHtml += `</div>`;
                detailsHtml += `<div style="background: rgba(255, 193, 7, 0.1); padding: 10px; border-radius: 8px; margin-top: 15px;">`;
                detailsHtml += `<strong style="color: #ffc107;">âš ï¸ IMMEDIATE ACTION REQUIRED</strong><br>`;
                detailsHtml += `â€¢ Alert law enforcement authorities<br>`;
                detailsHtml += `â€¢ Secure the area<br>`;
                detailsHtml += `â€¢ Document the detection<br>`;
                detailsHtml += `â€¢ Follow arrest protocols<br>`;
                detailsHtml += `</div>`;
                detailsHtml += `<small style="color: #a0a0a0;">Detection Time: ${new Date(data.match_timestamp).toLocaleString()}</small>`;
                
                detailsDiv.innerHTML = detailsHtml;
            } else {
                resultsDiv.classList.add('show');
                headerDiv.innerHTML = '<i class="fas fa-check-circle"></i> Database Search Complete - No Criminal Match';
                
                let detailsHtml = `<strong style="color: #00ff88; font-size: 18px;">âœ… CLEAN RECORD CONFIRMED</strong><br><br>`;
                detailsHtml += `<div style="background: rgba(0, 255, 136, 0.1); padding: 15px; border-radius: 8px; border-left: 4px solid #00ff88; margin: 10px 0;">`;
                detailsHtml += `<strong>Database Status:</strong> Complete search performed<br>`;
                detailsHtml += `<strong>Records Checked:</strong> ${data.database_size || 'All active'} criminal records<br>`;
                detailsHtml += `<strong>Scan Quality:</strong> ${data.scan_quality}%<br>`;
                detailsHtml += `<strong>Fingerprints Processed:</strong> 10/10 (Complete set)<br>`;
                detailsHtml += `<strong>Match Threshold:</strong> 75% (No matches above threshold)<br>`;
                detailsHtml += `<strong>Scan Type:</strong> Full 10-finger database comparison<br>`;
                detailsHtml += `</div>`;
                detailsHtml += `<div style="background: rgba(0, 255, 136, 0.05); padding: 10px; border-radius: 8px; margin-top: 15px;">`;
                detailsHtml += `<strong style="color: #00ff88;">âœ“ VERIFICATION COMPLETE</strong><br>`;
                detailsHtml += `This person is not in the criminal database.<br>`;
                detailsHtml += `All 10 fingerprints have been successfully processed and compared.`;
                detailsHtml += `</div>`;
                detailsHtml += `<small style="color: #a0a0a0;">Scan Time: ${new Date(data.match_timestamp || Date.now()).toLocaleString()}</small>`;
                
                detailsDiv.innerHTML = detailsHtml;
            }
        }
        
        // Scroll functionality
        function scrollToTop() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        }
        
        function scrollToBottom() {
            window.scrollTo({
                top: document.body.scrollHeight,
                behavior: 'smooth'
            });
        }
        
        function scrollToSection(sectionId) {
            const element = document.getElementById(sectionId);
            if (element) {
                element.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        }
        
        // Keyboard shortcuts for scrolling
        document.addEventListener('keydown', function(event) {
            switch(event.key) {
                case 'Home':
                    event.preventDefault();
                    scrollToTop();
                    break;
                case 'End':
                    event.preventDefault();
                    scrollToBottom();
                    break;
                case 'PageUp':
                    event.preventDefault();
                    window.scrollBy({
                        top: -window.innerHeight * 0.8,
                        behavior: 'smooth'
                    });
                    break;
                case 'PageDown':
                    event.preventDefault();
                    window.scrollBy({
                        top: window.innerHeight * 0.8,
                        behavior: 'smooth'
                    });
                    break;
            }
        });
        
        // Mouse wheel smooth scrolling enhancement
        let isScrolling = false;
        window.addEventListener('wheel', function(event) {
            if (!isScrolling) {
                isScrolling = true;
                setTimeout(() => {
                    isScrolling = false;
                }, 100);
            }
        }, { passive: true });
        
        // Cleanup on page unload
        window.addEventListener('beforeunload', function() {
            if (statusInterval) {
                clearInterval(statusInterval);
            }
        });
    </script>
</body>
</html>